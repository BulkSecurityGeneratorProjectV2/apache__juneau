<!--
/***************************************************************************************************************************
 * Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *  
 *  http://www.apache.org/licenses/LICENSE-2.0
 *  
 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations under the License.
 ***************************************************************************************************************************/
 -->

{title:'Object Tools', created:'9.0.0', flags:'TODO'}

<div class='topic'>
	<p>
		The {@link org.apache.juneau.objecttools} package defines convenience utility classes for accessing
		and manipulating POJOs.  It consists of the following classes:
	</p>
	<ul class='javatree'>
		<li class='jc'>{@link oaj.objecttools.ObjectRest}
		<li class='jc'>{@link oaj.objecttools.ObjectSearcher}
		<li class='jc'>{@link oaj.objecttools.ObjectSorter}
		<li class='jc'>{@link oaj.objecttools.ObjectViewer}
		<li class='jc'>{@link oaj.objecttools.ObjectPaginator}
		<li class='jc'>{@link oaj.objecttools.ObjectIntrospector}
		<li class='jc'>{@link oaj.objecttools.ObjectMerger}
	</ul>
	
	<h5 class='topic'>ObjectRest</h5>
	<p>
		The {@link oaj.objecttools.ObjectRest} class provides the ability to perform standard REST operations (GET, PUT, POST, DELETE) against nodes in a POJO model.
		Nodes in the POJO model are addressed using URLs.
	</p>
	<p>
		A POJO model is defined as a tree model where nodes consist of consisting of the following:
	</p>
	<ul class='spaced-list'>
		<li>
			{@link Map Maps} and Java beans representing JSON objects.
		<li>
			{@link Collection Collections} and arrays representing JSON arrays.
		<li>
			Java beans.
	</ul>
	<p>
		Leaves of the tree can be any type of object.
	</p>
	<p>
		Use {@link #get(String) get()} to retrieve an element from a JSON tree.
		<br>Use {@link #put(String,Object) put()} to create (or overwrite) an element in a JSON tree.
		<br>Use {@link #post(String,Object) post()} to add an element to a list in a JSON tree.
		<br>Use {@link #delete(String) delete()} to remove an element from a JSON tree.
	</p>
	<p>
		Leading slashes in URLs are ignored.
		So <js>"/xxx/yyy/zzz"</js> and <js>"xxx/yyy/zzz"</js> are considered identical.
 	</p>
	<h5 class='section'>Example:</h5>
	<p class='bjava'>
	|	<jc>// Construct an unstructured POJO model</jc>
	|	JsonMap <jv>map</jv> = JsonMap.<jsm>ofJson</jsm>(<js>""</js>
	|		+ <js>"{"</js>
	|		+ <js>"	name:'John Smith', "</js>
	|		+ <js>"	address:{ "</js>
	|		+ <js>"		streetAddress:'21 2nd Street', "</js>
	|		+ <js>"		city:'New York', "</js>
	|		+ <js>"		state:'NY', "</js>
	|		+ <js>"		postalCode:10021 "</js>
	|		+ <js>"	}, "</js>
	|		+ <js>"	phoneNumbers:[ "</js>
	|		+ <js>"		'212 555-1111', "</js>
	|		+ <js>"		'212 555-2222' "</js>
	|		+ <js>"	], "</js>
	|		+ <js>"	additionalInfo:null, "</js>
	|		+ <js>"	remote:false, "</js>
	|		+ <js>"	height:62.4, "</js>
	|		+ <js>"	'fico score':' &gt; 640' "</js>
	|		+ <js>"} "</js>
	|	);
	|
	|	<jc>// Wrap Map inside an ObjectRest object</jc>
	|	ObjectRest <jv>johnSmith</jv> = ObjectRest.<jsf>create</jsf>(<jv>map</jv>);
	|
	|	<jc>// Get a simple value at the top level</jc>
	|	<jc>// "John Smith"</jc>
	|	String <jv>name</jv> = <jv>johnSmith</jv>.getString(<js>"name"</js>);
	|
	|	<jc>// Change a simple value at the top level</jc>
	|	<jv>johnSmith</jv>.put(<js>"name"</js>, <js>"The late John Smith"</js>);
	|
	|	<jc>// Get a simple value at a deep level</jc>
	|	<jc>// "21 2nd Street"</jc>
	|	String <jv>streetAddress</jv> = <jv>johnSmith</jv>.getString(<js>"address/streetAddress"</js>);
	|
	|	<jc>// Set a simple value at a deep level</jc>
	|	<jv>johnSmith</jv>.put(<js>"address/streetAddress"</js>, <js>"101 Cemetery Way"</js>);
	|
	|	<jc>// Get entries in a list</jc>
	|	<jc>// "212 555-1111"</jc>
	|	String <jv>firstPhoneNumber</jv> = <jv>johnSmith</jv>.getString(<js>"phoneNumbers/0"</js>);
	|
	|	<jc>// Add entries to a list</jc>
	|	<jv>johnSmith</jv>.post(<js>"phoneNumbers"</js>, <js>"212 555-3333"</js>);
	|
	|	<jc>// Delete entries from a model</jc>
	|	<jv>johnSmith</jv>.delete(<js>"fico score"</js>);
	|
	|	<jc>// Add entirely new structures to the tree</jc>
	|	JsonMap <jv>medicalInfo</jv> = JsonMap.<jsm>ofJson</jsm>(<js>""</js>
	|		+ <js>"{"</js>
	|		+ <js>"	currentStatus: 'deceased',"</js>
	|		+ <js>"	health: 'non-existent',"</js>
	|		+ <js>"	creditWorthiness: 'not good'"</js>
	|		+ <js>"}"</js>
	|	);
	|	<jv>johnSmith</jv>.put(<js>"additionalInfo/medicalInfo"</js>, <jv>medicalInfo</jv>);
	</p>

	<p>
		In the special case of collections/arrays of maps/beans, a special XPath-like selector notation can be used in lieu
		of index numbers on GET requests to return a map/bean with a specified attribute value.
		<br>The syntax is {@code @attr=val}, where attr is the attribute name on the child map, and val is the matching value.
	</p>
	
	<h5 class='section'>Example:</h5>
	<p class='bjava'>
	|	<jc>// Get map/bean with name attribute value of 'foo' from a list of items</jc>
	|	Map <jv>map</jv> = <jv>objectRest</jv>.getMap(<js>"/items/@name=foo"</js>);
	</p>
	
	<h5 class='topic'>ObjectSearcher</h5>
	<p>
		The {@link ObjectSearcher} class is designed to provide searches across arrays and collections of beans and maps.
		It allows you to quickly filter beans and maps using simple yet sophisticated search arguments.
	</p>
	
	<h5 class='section'>Example:</h5>
	<p class='bjava'> 
	|	MyBean[] <jv>arrayOfBeans</jv> = ...;
	|	ObjectSearcher <jv>searcher</jv> = ObjectSearcher.<jsm>create</jsm>();
	|	BeanSession <jv>beanSession</jv> = BeanContext.<jsf>DEFAULT</jsf>.createSession();
	|	
	|	<jc>// Find beans whose 'foo' property is 'bar'.</jc>
	|	SearchArgs <jv>args</jv> = SearchArgs.create("foo=X,bar=Y");  
	|
	|	<jc>// Returns a list of beans whose 'foo' property is 'X' and 'bar' property is 'Y'.</jc>		
	|	Object <jv>result</jv> = searcher.run(<jv>beanSession</jv>, <jv>arrayOfBeans</jv>, <jv>args</jv>);  
	</p>
	<p>
		The default searcher is configured with the following matcher factories that provides the capabilities of matching
		against various data types:
	</p>
	<ul class='javatreec'>
		<li class='jc'>{@link oaj.objecttools.StringMatcherFactory}
		<li class='jc'>{@link oaj.objecttools.NumberMatcherFactory}
		<li class='jc'>{@link oaj.objecttools.TimeMatcherFactory}
	</ul>
	<p>
		The {@link oaj.objectools.StringMatcherFactory} class provides searching based on the following patterns:
	</p>
	<ul>
		<li><js>"property=foo"</js> - Simple full word match
		<li><js>"property=fo*"</js>, <js>"property=?ar"</js> - Meta-character matching
		<li><js>"property=foo bar"</js>(implicit), <js>"property=^foo ^bar"</js>(explicit) - Multiple OR'ed patterns
		<li><js>"property=+fo* +*ar"</js> - Multiple AND'ed patterns
		<li><js>"property=fo* -bar"</js> - Negative patterns
		<li><js>"property='foo bar'"</js> - Patterns with whitespace
		<li><js>"property=foo\\'bar"</js> - Patterns with single-quotes
		<li><js>"property=/foo\\s+bar"</js> - Regular expression match
	</ul>
	<p>
		The {@link oaj.objectools.NumberMatcherFactory} class provides searching based on the following patterns:
	</p>
	<ul>
		<li><js>"property=1"</js> - A single number
		<li><js>"property=1 2"</js> - Multiple OR'ed numbers
		<li><js>"property=-1 -2"</js> - Multiple OR'ed negative numbers
		<li><js>"property=1-2"</js>,<js>"property=-2--1"</js>  - A range of numbers (whitespace ignored)
		<li><js>"property=1-2 4-5"</js> - Multiple OR'ed ranges
		<li><js>"property=&lt;1"</js>,<js>"property=&lt;=1"</js>,<js>"property=&gt;1"</js>,<js>"property=&gt;=1"</js> - Open-ended ranges
		<li><js>"property=!1"</js>,<js>"property=!1-2"</js> - Negation
	</ul>
	<p>
		The {@link oaj.objectools.TimeMatcherFactory} class provides searching based on the following patterns:
	</p>
	<ul>
		<li><js>"property=2011"</js> - A single year
		<li><js>"property=2011 2013 2015"</js> - Multiple years
		<li><js>"property=2011-01"</js> - A single month
		<li><js>"property=2011-01-01"</js> - A single day
		<li><js>"property=2011-01-01T12"</js> - A single hour
		<li><js>"property=2011-01-01T12:30"</js> - A single minute
		<li><js>"property=2011-01-01T12:30:45"</js> - A single second
		<li><js>"property=&gt;2011"</js>,<js>"property=&gt;=2011"</js>,<js>"property=&lt;2011"</js>,<js>"property=&lt;=2011"</js> - Open-ended ranges
		<li><js>"property=&gt;2011"</js>,<js>"property=&gt;=2011"</js>,<js>"property=&lt;2011"</js>,<js>"property=&lt;=2011"</js> - Open-ended ranges
		<li><js>"property=2011 - 2013-06-30"</js> - Closed ranges
	</ul>

	<h5 class='topic'>ObjectSorter</h5>
	<p>
		The {@link ObjectSorter} class is designed to sort arrays and collections of beans and maps.
	</p>
	<h5 class='section'>Example:</h5>
	<p class='bjava'> 
	|	MyBean[] <jv>arrayOfBeans</jv> = ...;
	|	ObjectSorter <jv>sorter</jv> = ObjectSorter.<jsm>create</jsm>();
	|	BeanSession <jv>beanSession</jv> = BeanContext.<jsf>DEFAULT</jsf>.createSession();
	|	
	|	<jc>// Sort beans by foo ascending then bar descending.</jc>
	|	SortArgs <jv>args</jv> = SortArgs.create("foo,bar-");  
	|
	|	<jc>// Returns a list of beans sorted accordingly.</jc>		
	|	Object <jv>result</jv> = sorter.run(<jv>beanSession</jv>, <jv>arrayOfBeans</jv>, <jv>args</jv>);  
	</p>
	
	<h5 class='topic'>ObjectViewer</h5>
	<p>
		The {@link ObjectViewer} class is designed to extract properties from collections of maps and beans.
	</p>
	<h5 class='section'>Example:</h5>
	<p class='bjava'> 
	|	MyBean[] <jv>arrayOfBeans</jv> = ...;
	|	ObjectSorter <jv>sorter</jv> = ObjectSorter.<jsm>create</jsm>();
	|	BeanSession <jv>beanSession</jv> = BeanContext.<jsf>DEFAULT</jsf>.createSession();
	|	
	|	<jc>// Extract properties 'foo' and 'bar' from the beans.</jc>
	|	ViewArgs <jv>args</jv> = ViewArgs.create("foo,bar");  
	|
	|	<jc>// Returns list of maps with just .</jc>		
	|	Object <jv>result</jv> = sorter.run(<jv>beanSession</jv>, <jv>arrayOfBeans</jv>, <jv>sortArgs</jv>);  
	</p>

	//-----------------------------------------------------------------------------------------------------------------
	// Null input
	//-----------------------------------------------------------------------------------------------------------------

	@Test
	public void nullInput() {
		assertNull(p.run(bs, null, null));
	}

	//-----------------------------------------------------------------------------------------------------------------
	// Simple bean
	//-----------------------------------------------------------------------------------------------------------------

	public static class A {
		public String f1,f2;

		public static A create(String f1, String f2) {
			A a = new A();
			a.f1 = f1;
			a.f2 = f2;
			return a;
		}
	}

	@Test
	public void simpleBean() {
		ViewArgs sa = new ViewArgs("f1");;
		Object in = A.create("x1","x2");
		assertObject(p.run(bs, in, sa)).asJson().is("{f1:'x1'}");
	}

	@Test
	public void simpleBean_reverseColumns() {
		ViewArgs sa = new ViewArgs("f2","f1");
		Object in = A.create("x1","x2");
		assertObject(p.run(bs, in, sa)).asJson().is("{f2:'x2',f1:'x1'}");
	}

	@Test
	public void simpleBean_dupColumns() {
		ViewArgs sa = new ViewArgs("f1","f1");
		Object in = A.create("x1","x2");
		assertObject(p.run(bs, in, sa)).asJson().is("{f1:'x1'}");
	}

	@Test
	public void simpleBean_nonExistentColumns() {
		ViewArgs sa = new ViewArgs("fx");
		Object in = A.create("x1","x2");
		assertObject(p.run(bs, in, sa)).asJson().is("{}");
	}

	@Test
	public void simpleBean_nullColumn() {
		ViewArgs sa = new ViewArgs("f1",null);
		Object in = A.create("x1","x2");
		assertObject(p.run(bs, in, sa)).asJson().is("{f1:'x1'}");
	}

	@Test
	public void simpleBean_emptyArgs() {
		ViewArgs sa = new ViewArgs();
		Object in = A.create("x1","x2");
		assertObject(p.run(bs, in, sa)).asJson().is("{}");
	}

	//-----------------------------------------------------------------------------------------------------------------
	// Simple BeanMap
	//-----------------------------------------------------------------------------------------------------------------

	@Test
	public void simpleBeanMap() {
		ViewArgs sa = new ViewArgs("f1");
		Object in = bs.toBeanMap(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("{f1:'x1'}");
	}

	//-----------------------------------------------------------------------------------------------------------------
	// Simple map
	//-----------------------------------------------------------------------------------------------------------------

	@Test
	public void simpleMap() {
		ViewArgs sa = new ViewArgs("f1");
		Object in = map("f1","x1","f2","x2");
		assertObject(p.run(bs, in, sa)).asJson().is("{f1:'x1'}");
	}

	@Test
	public void simpleMap_reverseColumns() {
		ViewArgs sa = new ViewArgs("f2","f1");
		Object in = map("f1","x1","f2","x2");
		assertObject(p.run(bs, in, sa)).asJson().is("{f2:'x2',f1:'x1'}");
	}

	@Test
	public void simpleMap_nonExistentColumns() {
		ViewArgs sa = new ViewArgs("fx");
		Object in = map("f1","x1","f2","x2");
		assertObject(p.run(bs, in, sa)).asJson().is("{}");
	}

	@Test
	public void simpleMap_nullColumn() {
		ViewArgs sa = new ViewArgs("f1",null);
		Object in = map("f1","x1","f2","x2");
		assertObject(p.run(bs, in, sa)).asJson().is("{f1:'x1'}");
	}

	@Test
	public void simpleMap_emptyView() {
		ViewArgs sa = new ViewArgs();
		Object in = map("f1","x1","f2","x2");
		assertObject(p.run(bs, in, sa)).asJson().is("{}");
	}

	//-----------------------------------------------------------------------------------------------------------------
	// Bean array
	//-----------------------------------------------------------------------------------------------------------------

	@Test
	public void beanArray() {
		ViewArgs sa = new ViewArgs("f1");;
		Object in = new A[]{A.create("x1","x2")};
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'}]");
	}

	@Test
	public void beanArray_reverseColumns() {
		ViewArgs sa = new ViewArgs("f2","f1");
		Object in = new A[]{A.create("x1","x2")};
		assertObject(p.run(bs, in, sa)).asJson().is("[{f2:'x2',f1:'x1'}]");
	}

	@Test
	public void beanArray_dupColumns() {
		ViewArgs sa = new ViewArgs("f1","f1");
		Object in = new A[]{A.create("x1","x2")};
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'}]");
	}

	@Test
	public void beanArray_nonExistentColumns() {
		ViewArgs sa = new ViewArgs("fx");
		Object in = new A[]{A.create("x1","x2")};
		assertObject(p.run(bs, in, sa)).asJson().is("[{}]");
	}

	@Test
	public void beanArray_nullColumn() {
		ViewArgs sa = new ViewArgs("f1",null);
		Object in = new A[]{A.create("x1","x2")};
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'}]");
	}

	@Test
	public void beanArray_emptyArgs() {
		ViewArgs sa = new ViewArgs();
		Object in = new A[]{A.create("x1","x2")};
		assertObject(p.run(bs, in, sa)).asJson().is("[{}]");
	}

	@Test
	public void beanArray_withNull() {
		ViewArgs sa = new ViewArgs("f1");;
		Object in = new A[]{A.create("x1","x2"),null};
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'},null]");
	}

	//-----------------------------------------------------------------------------------------------------------------
	// Bean list
	//-----------------------------------------------------------------------------------------------------------------

	@Test
	public void beanList() {
		ViewArgs sa = new ViewArgs("f1");;
		Object in = list(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'}]");
	}

	@Test
	public void beanList_reverseColumns() {
		ViewArgs sa = new ViewArgs("f2","f1");
		Object in = list(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{f2:'x2',f1:'x1'}]");
	}

	@Test
	public void beanList_dupColumns() {
		ViewArgs sa = new ViewArgs("f1","f1");
		Object in = list(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'}]");
	}

	@Test
	public void beanList_nonExistentColumns() {
		ViewArgs sa = new ViewArgs("fx");
		Object in = list(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{}]");
	}

	@Test
	public void beanList_nullColumn() {
		ViewArgs sa = new ViewArgs("f1",null);
		Object in = list(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'}]");
	}

	@Test
	public void beanList_emptyArgs() {
		ViewArgs sa = new ViewArgs();
		Object in = list(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{}]");
	}

	@Test
	public void beanList_withNull() {
		ViewArgs sa = new ViewArgs("f1");;
		Object in = list(A.create("x1","x2"),null);
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'},null]");
	}

	//-----------------------------------------------------------------------------------------------------------------
	// Bean set
	//-----------------------------------------------------------------------------------------------------------------

	@Test
	public void beanSet() {
		ViewArgs sa = new ViewArgs("f1");;
		Object in = set(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'}]");
	}

	@Test
	public void beanSet_reverseColumns() {
		ViewArgs sa = new ViewArgs("f2","f1");
		Object in = set(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{f2:'x2',f1:'x1'}]");
	}

	@Test
	public void beanSet_dupColumns() {
		ViewArgs sa = new ViewArgs("f1","f1");
		Object in = set(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'}]");
	}

	@Test
	public void beanSet_nonExistentColumns() {
		ViewArgs sa = new ViewArgs("fx");
		Object in = set(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{}]");
	}

	@Test
	public void beanSet_nullColumn() {
		ViewArgs sa = new ViewArgs("f1",null);
		Object in = set(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'}]");
	}

	@Test
	public void beanSet_emptyArgs() {
		ViewArgs sa = new ViewArgs();
		Object in = set(A.create("x1","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{}]");
	}

	@Test
	public void beanSet_withNull() {
		ViewArgs sa = new ViewArgs("f1");;
		Object in = set(A.create("x1","x2"),null);
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'},null]");
	}

	//-----------------------------------------------------------------------------------------------------------------
	// Other object
	//-----------------------------------------------------------------------------------------------------------------

	@Test
	public void otherObject() {
		ViewArgs sa = new ViewArgs("f1");;
		Object in = "foobar";
		assertObject(p.run(bs, in, sa)).asJson().is("'foobar'");
	}

	//-----------------------------------------------------------------------------------------------------------------
	// Map list
	//-----------------------------------------------------------------------------------------------------------------

	@Test
	public void mapList() {
		ViewArgs sa = new ViewArgs("f1");;
		Object in = list(map("f1","x1","f2","x2"));
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'}]");
	}

	//-----------------------------------------------------------------------------------------------------------------
	// BeanMap list
	//-----------------------------------------------------------------------------------------------------------------

	@Test
	public void beanMapList() {
		ViewArgs sa = new ViewArgs("f1");;
		Object in = list(bs.toBeanMap(A.create("x1","x2")));
		assertObject(p.run(bs, in, sa)).asJson().is("[{f1:'x1'}]");
	}

	//-----------------------------------------------------------------------------------------------------------------
	// Other object list
	//-----------------------------------------------------------------------------------------------------------------

	@Test
	public void otherObjectList() {
		ViewArgs sa = new ViewArgs("f1");;
		Object in = list("foobar");
		assertObject(p.run(bs, in, sa)).asJson().is("['foobar']");
	}
	
	
	 * Designed to provide paging on POJOs consisting of arrays and collections.
 *
 * <p>
 * Allows you to quickly return subsets of arrays and collections based on position/limit arguments.
	
	
	<h5 class='topic'>ObjectPaginator</h5>
	<h5 class='topic'>ObjectIntrospector</h5>
	<h5 class='topic'>ObjectMerger</h5>
</div>