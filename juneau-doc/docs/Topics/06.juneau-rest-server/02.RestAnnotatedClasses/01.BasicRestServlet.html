<!--
/***************************************************************************************************************************
 * Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *  
 *  http://www.apache.org/licenses/LICENSE-2.0
 *  
 * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations under the License.
 ***************************************************************************************************************************/
 -->

{title:'BasicRestServlet', updated:'8.1.0,9.0.0'} 

<p>
	The {@link oajr.BasicRestServlet} class is a subclass of {@link oajr.RestServlet}
	preconfigured with the following:
</p>
<ul class='spaced-list'>
	<li>A default set of serializers and parsers (pretty much all of them except for the RDF ones).
	<li>Some basic HTML boilerplate for the HTML representation of your POJOs.
	<li>Support for auto-generated Swagger documentation.
	<li>Support for runtime timing statistics.
	<li>Support for serving static files.
	<li>Configuration of default CSS stylesheets.
</ul>
<p>
	The following shows the code that makes up this class.
</p>

<h5 class='figure'>BasicRestServlet.java</h5>
<p class='bpcode w800'>
	<ja>@Rest</ja>
	<jk>public abstract class</jk> BasicRestServlet <jk>extends</jk> RestServlet 
		<jk>implements</jk> BasicUniversalRest, BasicRestOperations {
	
		<ja>@Override</ja> <jc>/* BasicRestOperations */</jc>
		<jk>public</jk> Swagger getSwagger(RestRequest <jv>req</jv>) {
			<jk>return</jk> <jv>req</jv>.getSwagger().orElseThrow(NotFound::<jk>new</jk>);
		}
	
		<ja>@Override</ja> <jc>/* BasicRestOperations */</jc>
		<jk>public</jk> HttpResource getHtdoc(<ja>@Path</ja>(<js>"/*"</js>) String <jv>path</jv>, Locale <jv>locale</jv>) <jk>throws</jk> NotFound {
			<jk>return</jk> getContext().getStaticFiles().resolve(<jv>path</jv>, <jv>locale</jv>).orElseThrow(NotFound::<jk>new</jk>);
		}
	
		<ja>@Override</ja> <jc>/* BasicRestOperations */</jc>
		<jk>public</jk> HttpResource getFavIcon() {
			String <jv>favIcon</jv> = getContext().getConfig().getString(<js>"REST/favicon"</js>, <js>"images/juneau.png"</js>);
			<jk>return</jk> getHtdoc(<jv>favIcon</jv>, <jk>null</jk>);
		}
	
		<ja>@Override</ja> <jc>/* BasicRestOperations */</jc>
		<jk>public void</jk> error() {}
	
		<ja>@Override</ja> <jc>/* BasicRestOperations */</jc>
		<jk>public</jk> RestContextStats getStats(RestRequest <jv>req</jv>) {
			<jk>return</jk> <jv>req</jv>.getContext().getStats();
		}
	}
</p>

<h5 class='figure'>BasicUniversalRest.java</h5>
<p class='bpcode w800'>
	<ja>@Rest</ja>(
	
		<jc>// Default serializers for all Java methods in the class.</jc>
		serializers={
			HtmlDocSerializer.<jk>class</jk>, 
			HtmlStrippedDocSerializer.<jk>class</jk>,
			HtmlSchemaDocSerializer.<jk>class</jk>,
			JsonSerializer.<jk>class</jk>,
			SimpleJsonSerializer.<jk>class</jk>,
			JsonSchemaSerializer.<jk>class</jk>,
			XmlDocSerializer.<jk>class</jk>,
			UonSerializer.<jk>class</jk>,
			UrlEncodingSerializer.<jk>class</jk>,
			OpenApiSerializer.<jk>class</jk>,
			MsgPackSerializer.<jk>class</jk>,
			SoapXmlSerializer.<jk>class</jk>,
			PlainTextSerializer.<jk>class</jk>
		},
	
		<jc>// Default parsers for all Java methods in the class.</jc>
		parsers={
			JsonParser.<jk>class</jk>,
			SimpleJsonParser.<jk>class</jk>,
			XmlParser.<jk>class</jk>,
			HtmlParser.<jk>class</jk>,
			UonParser.<jk>class</jk>,
			UrlEncodingParser.<jk>class</jk>,
			OpenApiParser.<jk>class</jk>,
			MsgPackParser.<jk>class</jk>,
			PlainTextParser.<jk>class</jk>
		},
	
		<jc>// Optional external configuration file.</jc>
		config=<js>"$S{juneau.configFile,SYSTEM_DEFAULT}"</js>
	)
	<ja>@SerializerConfig</ja>(
		<jc>// Enable automatic resolution of URI objects to root-relative values.</jc>
		uriResolution=<js>"ROOT_RELATIVE"</js>
	)
	<ja>@HtmlDocConfig</ja>(
	
		<jc>// Default page header contents.</jc>
		header={
			<js>"&lt;h1>$RS{title}&lt;/h1>"</js>,  <jc>// Use @Rest(title)</jc>
			<js>"&lt;h2>$RS{operationSummary,description}&lt;/h2>"</js>, <jc>// Use @RestOp(summary) or @Rest(description)</jc>
			<js>"$C{REST/header}"</js>  <jc>// Extra header HTML defined in external config file.</jc>
		},
	
		<jc>// Basic page navigation links.</jc>
		navlinks={
			<js>"up: request:/.."</js>
		},
	
		<jc>// Default stylesheet to use for the page.
		// Can be overridden from external config file.
		// Default is DevOps look-and-feel (aka Depression look-and-feel).</jc>
		stylesheet=<js>"$C{REST/theme,servlet:/htdocs/themes/devops.css}"</js>,
	
		<jc>// Default contents to add to the &gt;head> section of the HTML page.</jc>
		// Use it to add a favicon link to the page.</head>
		head=<js>"$C{REST/head}"</js>,
	
		<jc>// No default page footer contents.
		// Can be overridden from external config file.</jc>
		footer=<js>"$C{REST/footer}"</js>,
	
		<jc>// By default, table cell contents should not wrap.</jc>
		nowrap=<js>"true"</js>
	)
	<ja>@BeanConfig</ja>(
		<jc>// When parsing generated beans, ignore unknown properties that may only exist as getters and not setters.</jc>
		ignoreUnknownBeanProperties=<js>"true"</js>
	)
	<jk>public interface</jk> BasicUniversalRest {}
</p>

<h5 class='figure'>BasicRestOperations.java</h5>
<p class='bpcode w800'>
	<ja>@HtmlDocConfig</ja>(
		<jc>// Basic page navigation links.</jc>
		navlinks={
			<js>"up: request:/.."</js>,
			<js>"api: servlet:/api"</js>,
			<js>"stats: servlet:/stats"</js>
		}
	)
	<ja>@JsonSchemaConfig</ja>(
		<jc>// Add descriptions to the following types when not specified:</jc>
		addDescriptionsTo=<js>"bean,collection,array,map,enum"</js>,
		<jc>// Add example to the following types:</jc>
		addExamplesTo=<js>"bean,collection,array,map"</js>,
		<jc>// Don't generate schema information on the Swagger bean itself or HTML beans.</jc>
		ignoreTypes=<js>"Swagger,org.apache.juneau.dto.html5.*"</js>,
		<jc>// Use $ref references for bean definitions to reduce duplication in Swagger.</jc>
		useBeanDefs=<js>"true"</js>
	)
	<jk>public interface</jk> BasicRestOperations {
	
		<ja>@RestGet</ja>(
			path=<js>"/api/*"</js>,
			summary=<js>"Swagger documentation"</js>,
			description=<js>"Swagger documentation for this resource."</js>
		)
		<ja>@HtmlDocConfig</ja>(
			<jc>// Should override config annotations defined on class.</jc>
			rank=10,
			<jc>// Override the nav links for the swagger page.</jc>
			navlinks={
				<js>"back: servlet:/"</js>,
				<js>"json: servlet:/?Accept=text/json&plainText=true"</js>
			},
			<jc>// Never show aside contents of page inherited from class.</jc>
			aside=<js>"NONE"</js>
		)
		<ja>@BeanConfig</ja>(
			<jc>// POJO swaps to apply to all serializers/parsers on this method.</jc>
			swaps={
				<jc>// Use the SwaggerUI swap when rendering Swagger beans.
				// This is a per-media-type swap that only applies to text/html requests.</jc>
				SwaggerUI.<jk>class</jk>
			}
		)
		<jk>public</jk> Swagger getSwagger(RestRequest <jv>req</jv>);
	
		<ja>@RestGet</ja>(
			path=<js>"/htdocs/*"</js>,
			summary=<js>"Static files"</js>,
			description=<js>"Static file retrieval."</js>
		)
		<jk>public</jk> HttpResource getHtdoc(<ja>@Path</ja> String <jv>path</jv>, Locale <jv>locale</jv>);
	
		<ja>@RestGet</ja>(
			path=<js>"favicon.ico"</js>,
			summary=<js>"Favorites icon."</js>,
			description=<js>"Favorites icon."</js>
		)
		<jk>public</jk> HttpResource getFavIcon();
	
		<ja>@RestOp</ja>(
			method=<jsf>ANY</jsf>,
			path=<js>"/error"</js>,
			summary=<js>"Error occurred"</js>,
			description={
				<js>"An error occurred during handling of the request.  "</js>,
				<js>"Servlet chains will often automatically redirect to '/error' when any sort of error condition occurs "</js>,
				<js>"(such as failed authentication) and will set appropriate response parameters "</js>,
				<js>"(such as an WWW-Authenticate response header)."</js>
			}
		)
		<jk>public void</jk> error();

		<ja>@RestGet</ja>(
			path=<js>"/stats"</js>,
			summary=<js>"Timing statistics"</js>,
			description=<js>"Timing statistics for method invocations on this resource."</js>
		)
		<ja>@HtmlDocConfig</ja>(
			<jc>// Should override config annotations defined on class.</jc>
			rank=10,
			<jc>// Override the nav links for the swagger page.</jc>
			navlinks={
				<js>"back: servlet:/"</js>,
				<js>"json: servlet:/stats?Accept=text/json&plainText=true"</js>
			},
			<jc>// Never show aside contents of page inherited from class.</jc>
			aside=<js>"NONE"</js>
		)
		<jk>public</jk> RestContextStats getStats(RestRequest <jv>req</jv>);
	}
</p>
<p>
	Your top-level resource will simply extend from this class, as shown in the Hello World example
	from a couple sections back.
</p>
<p>
	It's important to notice that the <ja>@Rest</ja> annotation is inheritable and overridable from parent
	class and interfaces.  
	They'll all get merged into a single set of annotation values for the resource class.
</p>
<p>
	Not shown but equally important is that all of the annotations shown have programmatic equivalents via the {@link oajr.RestContext.Builder} class
	which can be manipulated during servlet initialization.
	(As a general rule, all annotations throughout Juneau have programmatic equivalents.)
</p>
<p>
	<i>Note:</i>  {@link oajr.BasicRestServletJena} is the equivalent class that includes support for RDF languages.
</p>
